Content Types installed: <%= @content_types.size %> 

<p>

<% for type in @content_types %>
  <%= type.friendly_name %> - <%= type %> <br/>
<% end %>

<p>
  
Addresses: <%= Inkling::Address.all.size %>

<p>
	
<%= form_tag(admin_inkling_proxy_new_path, :method => :post) do %>
       <%= select_tag(:content_type,
                      options_for_select(@content_types.collect{|c| [ c.friendly_name, c.to_s]}.insert (0, "")),
                      :onchange=>"this.form.submit()") %>
 <% end %>

<p>  
Content Tree:

<ul id="tag-tree">
  <%= render(:partial => "address", :collection => @roots) %>
</ul>



<% content_for :js do %>
  <% javascript_tag do %>
    $(document).ready(function(){

        $("li.tree-item span").droppable({
            tolerance        : "pointer",
            hoverClass        : "tree-hover",
            drop            : function(event, ui){
                var dropped = ui.draggable;
                dropped.css({top: 0, left: 0});
                var me = $(this).parent();
                if(me == dropped)
                    return;
                var subbranch = $(me).children("ul");
                if(subbranch.size() == 0) {
                    me.find("span").after("<ul></ul>");
                    subbranch = me.find("ul");
                }
                var oldParent = dropped.parent();
                subbranch.eq(0).append(dropped);
                var oldBranches = $("li", oldParent);

                var newParent = me.attr('id')
                var child = dropped.attr('id')

                $.post("/admin/inkling/folder_entries/update_tree", {new_parent: newParent, child: child});
            }
        });

        $("li.tree-item").draggable({
            opacity: 0.5,
            revert: true
        });
    }); 

    // shows the content form
    function toggle_content_form(id){
    content_form = document.getElementById("content-form-" + id)
//    content_form = $("#content-form-" + id)

    if (content_form.style.display == "none")
      content_form.style.display = "block"
    else
      content_form.style.display = "none"
    }
  <% end %>
<% end %>
